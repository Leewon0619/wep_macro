<!doctype html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>WEP Macro Studio</title>
  <link rel="stylesheet" href="./styles.css" />
</head>
<body>
  <main class="app">
    <header class="card hero">
      <h1>WEP Macro Studio</h1>
      <p>편집/저장/실행/로그/화면녹화 + 확장 프로토콜 기반 매크로</p>
    </header>

    <section class="layout">
      <article class="card">
        <div class="row">
          <h2>매크로 목록</h2>
          <button id="addMacro" class="primary">+ 생성</button>
        </div>
        <ul id="macroList" class="macro-list"></ul>
      </article>

      <article class="card">
        <h2>매크로 편집</h2>
        <div class="grid-2">
          <label>이름<input id="macroName" type="text" /></label>
          <label>허용 도메인(comma)<input id="allowedDomains" type="text" placeholder="example.com, localhost" /></label>
          <label>반복 횟수(0=무한)<input id="repeatCount" type="number" min="0" value="1" /></label>
          <label>기본 step timeout(ms)<input id="defaultStepTimeoutMs" type="number" min="100" value="8000" /></label>
          <label>기본 retry<input id="defaultRetryCount" type="number" min="0" value="1" /></label>
          <label>backoff(ms)<input id="backoffMs" type="number" min="0" value="500" /></label>
          <label>maxDuration(ms)<input id="maxDurationMs" type="number" min="1000" value="1800000" /></label>
          <label>maxTotalSteps<input id="maxTotalSteps" type="number" min="1" value="20000" /></label>
          <label>maxRepeatsHardLimit<input id="maxRepeatsHardLimit" type="number" min="1" value="10000" /></label>
          <label>maxActionsPerSecond<input id="maxActionsPerSecond" type="number" min="1" value="8" /></label>
        </div>
        <div class="row">
          <label class="inline"><input id="blockSensitiveInputs" type="checkbox" checked /> 민감 입력 차단</label>
          <label class="inline"><input id="maskLogs" type="checkbox" checked /> 로그 마스킹</label>
        </div>
        <div class="row">
          <button id="saveMacro">저장</button>
          <button id="deleteMacro" class="danger">삭제</button>
          <button id="exportMacro">내보내기</button>
          <input id="importFile" type="file" accept="application/json,.json" />
        </div>
      </article>
    </section>

    <section class="card">
      <div class="row">
        <h2>스텝 편집기</h2>
        <div class="row">
          <button data-add="CLICK">+CLICK</button>
          <button data-add="TYPE">+TYPE</button>
          <button data-add="WAIT">+WAIT</button>
          <button data-add="SCROLL">+SCROLL</button>
          <button data-add="ASSERT">+ASSERT</button>
          <button data-add="SET_VAR">+SET_VAR</button>
          <button data-add="IF">+IF</button>
          <button data-add="LABEL">+LABEL</button>
          <button data-add="GOTO">+GOTO</button>
        </div>
      </div>
      <table>
        <thead>
          <tr><th>#</th><th>type</th><th>config</th><th>retry/onFail</th><th>del</th></tr>
        </thead>
        <tbody id="stepTable"></tbody>
      </table>
    </section>

    <section class="layout">
      <article class="card">
        <h2>녹화 제어</h2>
        <div class="grid-2">
          <label class="inline"><input id="recordClick" type="checkbox" checked /> recordClick</label>
          <label class="inline"><input id="recordInput" type="checkbox" checked /> recordInput</label>
          <label class="inline"><input id="recordScroll" type="checkbox" checked /> recordScroll</label>
          <label class="inline"><input id="insertWait" type="checkbox" checked /> insertWait</label>
          <label>waitThresholdMs<input id="waitThresholdMs" type="number" value="250" min="0" /></label>
          <label>inputDebounceMs<input id="inputDebounceMs" type="number" value="300" min="0" /></label>
          <label class="inline"><input id="dedupeClicks" type="checkbox" checked /> dedupeClicks</label>
          <label class="inline"><input id="ignoreWhileRunning" type="checkbox" checked /> ignoreWhileRunning</label>
        </div>
        <div class="row">
          <button id="recStart">녹화 시작</button>
          <button id="recStop">녹화 중지</button>
        </div>
      </article>

      <article class="card">
        <h2>실행 제어</h2>
        <div class="grid-2">
          <label>repeat override<input id="runRepeatCount" type="number" min="0" placeholder="optional" /></label>
          <label>maxDuration override(ms)<input id="runMaxDurationMs" type="number" min="0" placeholder="optional" /></label>
          <label>maxTotalSteps override<input id="runMaxTotalSteps" type="number" min="0" placeholder="optional" /></label>
          <label>stepDelayJitterMs<input id="stepDelayJitterMs" type="number" min="0" value="0" /></label>
          <label class="inline"><input id="dryRun" type="checkbox" /> dryRun</label>
          <label class="inline"><input id="ssOnFail" type="checkbox" checked /> screenshots.onFail</label>
          <label class="inline"><input id="ssOnEachStep" type="checkbox" /> screenshots.onEachStep</label>
        </div>
        <div class="row">
          <button id="runStart" class="primary">실행</button>
          <button id="runPause">일시정지</button>
          <button id="runResume">재개</button>
          <button id="runStop" class="danger">중지</button>
        </div>
      </article>
    </section>

    <section class="card">
      <h2>화면 녹화</h2>
      <div class="row">
        <button id="screenRecStart">화면 녹화 시작</button>
        <button id="screenRecStop">화면 녹화 중지</button>
        <label class="inline"><input id="screenAudio" type="checkbox" /> audio</label>
        <label>frameRate<input id="screenFrameRate" type="number" value="15" min="1" max="60" /></label>
        <select id="screenSavePolicy">
          <option value="LOCAL_ONLY">LOCAL_ONLY</option>
          <option value="ASK_UPLOAD">ASK_UPLOAD</option>
        </select>
      </div>
      <div class="row">
        <a id="screenDownload" href="#" download="screen-recording.webm">다운로드</a>
        <span id="screenInfo" class="muted">녹화 세션 없음</span>
      </div>
    </section>

    <section class="layout">
      <article class="card">
        <h2>상태 / 로그</h2>
        <pre id="status">ready</pre>
        <table>
          <thead><tr><th>time</th><th>type</th><th>phase</th><th>step</th><th>msg</th></tr></thead>
          <tbody id="logBody"></tbody>
        </table>
      </article>

      <article class="card">
        <h2>테스트 페이지</h2>
        <iframe id="playground" src="./demo.html" title="playground"></iframe>
      </article>
    </section>
  </main>

  <script type="module" src="./app.js"></script>
</body>
</html>
